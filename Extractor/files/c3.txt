SELECT
  CASE
    WHEN A.TP_PESSOA = 'F'
    THEN LPAD(A.CD_CPFCGC,11,0) -- CPF 11 CARACTERES COMPLETANDO COM ZEROS A ESQUERDA
    ELSE LPAD(A.CD_CPFCGC,14,0) -- CNPJ 14 CARACTERES COMPLETANDO COM ZEROS A ESQUERDA
  END                             AS CPF_CONTRIBUINTE,
  A.NM_CLIENTE                    AS NM_CONTRIBUINTE,
  REPLACE(B.NM_LOGRADOURO,';','') AS LOGRADOURO,
  B.NR_PREDIO                     AS NUMERO,
  REPLACE(B.NM_COMP_ENDE,';','')  AS COMPLEMENTO,
  ''                              AS CODIGO_MUNICIPIO,
  B.NM_BAIRRO                     AS BAIRRO,
  B.NM_CIDADE                     AS CIDADE,
  B.SG_ESTADO                     AS ESTADO,
  TO_CHAR(B.CD_DDD_TEL)
  || '-'
  || TO_CHAR(B.NR_TELEFONE) AS TELEFONE,
  TO_CHAR(A.DT_NASC_FUND, 'DDMMYYYY') AS DATA_NASCIMENTO,
  G.TP_CONTA                AS TIPO_CONTA,   --TIPO DE CONTA
  G.CD_BANCO                AS CODIGO_BANCO, --CODIGO DO BANCO
  G.CD_AGENCIA
  || '-'
  || G.DV_AGENCIA AS AGENCIA,      --CODIGO DA AGENCIA
  ''              AS NOME_AGENCIA, --NOME DA AGENCIA
  G.NR_CONTA
  || '-'
  || G.DV_CONTA AS CONTA_CORRENTE, --CONTA CORRENTE
  A.DT_CRIACAO  AS DATA_INCLUSAO,
  A.DT_ATUALIZ  AS DATA_ULTIMA_ATUALIZACAO,
  C.SG_PAIS     AS PAIS,
  -- NUMERO DE IDENTIFICACAO FISCAL (SE ESTRANGEIRO)
  -- NATUREZA DE RELAÇÃO (SE PJ
  --IDENTIFICAÇÃO DE MICROEMPRE (SE EMPRESA)
  --DOCUMETNO FISCAL EMITIDO (SE PJ)
  D.NM_E_MAIL                                          AS EMAIL,
  A.TP_PESSOA                                          AS PESSOA_FISICA_JURIDICA,
  ''                                                   AS DISPENSADO_NIF,
  DECODE(A.IN_SITUAC, 'A', 'A', 'D', 'I')              AS STATUS_CONTRIBUINTE,
  B.IN_TIPO_ENDE                                       AS TIPO_LOGRADOURO,
  'S'                                                  AS CENTRALIZAR_GERACAO_INFORMES,
  1                                                    AS TIPOS_INFORMES_CENTRALIZADOS,
  C.ID_SEXO                                            AS SEXO,
  DECODE(C.CD_EST_CIVIL, 1, 1, 5, 2, 2, 3, 4, 4, 3, 5) AS ESTADO_CIVIL,
  B.CD_DDD_CELULAR1
  || '-'
  || B.NR_CELULAR1 AS FONE_ALTERNATIVO,
  ''               AS EMAIL_ALTERNATIVO,
  --C.COD_CIDADE_NASC AS CIDADE_NASCIMENTO, --CONSULTAR MUNICIPIO,
  E.NOME_MUNI  AS CIDADE_NASCIMENTO,
  C.SG_PAIS    AS PAIS_NASCIMENTO,
  C.NM_MAE     AS NOME_MAE,
  C.NM_PAI     AS NOME_PAI,
  F.CD_CLIENTE AS CODIGO_CLIENTE
FROM CORRWIN.TSCCLIGER A
LEFT JOIN CORRWIN.TSCENDE B
ON A.CD_CPFCGC     = B.CD_CPFCGC
AND B.IN_TIPO_ENDE = 'R'
LEFT JOIN CORRWIN.TSCCLICOMP C
ON A.CD_CPFCGC     = C.CD_CPFCGC
AND A.CD_CON_DEP   = C.CD_CON_DEP
AND A.DT_NASC_FUND = C.DT_NASC_FUND
LEFT JOIN CORRWIN.TSCEMAIL D
ON A.CD_CPFCGC     = D.CD_CPFCGC
AND A.CD_CON_DEP   = D.CD_CON_DEP
AND A.DT_NASC_FUND = D.DT_NASC_FUND
AND D.IN_PRINCIPAL = 'S'
LEFT JOIN CORRWIN.TSCDXMUNICIPIO E
ON C.COD_CIDADE_NASC = E.COD_MUNI
LEFT JOIN CORRWIN.TSCCLIBOL F
ON A.CD_CPFCGC     = F.CD_CPFCGC
AND A.CD_CON_DEP   = F.CD_CON_DEP
AND A.DT_NASC_FUND = F.DT_NASC_FUND
LEFT JOIN CORRWIN.TSCCLICTA G
ON F.CD_CLIENTE    = G.CD_CLIENTE
AND G.IN_PRINCIPAL = 'S'
AND G.TP_CONTA     = 'CC'
AND G.NR_CONTA    IS NOT NULL;